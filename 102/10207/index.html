<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥ç³»ç‰ç’ƒæƒ…ç·’è™•æ–¹ç®‹ â™¡ è³ªæ„Ÿç‰ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Kiwi+Maru:wght@500&family=Mochiy+Pop+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-pink: #FFF9FA; --accent-pink: #FF9EAF;
            --m-pink: #FFD1DC; --m-blue: #D6EFFF; --m-orange: #FFE4D1; --m-purple: #EBDDFF; --m-green: #D7F5E1;
        }

        * { 
            font-family: 'Kiwi Maru', 'Mochiy Pop One', sans-serif !important; 
            font-weight: 500 !important; 
            box-sizing: border-box;
        }

        body {
            background-color: var(--bg-pink);
            background-image: radial-gradient(circle, #FFE4E9 1.2px, transparent 1.2px);
            background-size: 40px 40px; margin: 0; display: flex; justify-content: center; align-items: center;
            min-height: 100vh; color: #6D5A5A; overflow-x: hidden;
        }

        .container {
            background: rgba(255, 255, 255, 0.92); backdrop-filter: blur(10px);
            width: 95%; max-width: 650px; padding: 3.5rem 2rem; border-radius: 60px;
            text-align: center; border: 10px solid white; box-shadow: 0 30px 80px rgba(255, 174, 188, 0.3);
        }

        h1 { font-size: 2.6rem; color: var(--accent-pink); margin-bottom: 2.5rem; letter-spacing: 2px; }

        .button-group { display: flex; justify-content: space-between; gap: 10px; margin-bottom: 3.5rem; }
        .mood-wrapper { display: flex; flex-direction: column; align-items: center; flex: 1; }

        .mood-btn {
            position: relative; border: none; font-size: 2.8rem; width: 85px; height: 85px; border-radius: 35px;
            cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05), inset 0 -6px 8px rgba(0,0,0,0.05), inset 0 6px 8px rgba(255,255,255,0.8);
            -webkit-tap-highlight-color: transparent;
        }

        .mood-btn:hover { transform: translateY(-8px) scale(1.05); }
        .mood-label { font-size: 1.2rem; margin-top: 15px; color: #9B8686; }

        .btn-happy { background: radial-gradient(circle at 30% 30%, #fff, var(--m-pink)); }
        .btn-sad { background: radial-gradient(circle at 30% 30%, #fff, var(--m-blue)); }
        .btn-angry { background: radial-gradient(circle at 30% 30%, #fff, var(--m-orange)); }
        .btn-tired { background: radial-gradient(circle at 30% 30%, #fff, var(--m-purple)); }
        .btn-cheer { background: radial-gradient(circle at 30% 30%, #fff, var(--m-green)); }

        .sparkle { position: absolute; pointer-events: none; animation: dream-fly 1s forwards ease-out; z-index: 1000; }
        @keyframes dream-fly { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; } 100% { transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) scale(1.2) rotate(360deg); opacity: 0; } }

        #result-area { display: none; animation: fadeIn 0.8s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .quote { font-size: 1.8rem; color: #5A4A4A; margin-bottom: 2rem; line-height: 1.6; }
        .song-intro-label { font-size: 1.1rem; color: var(--accent-pink); margin-bottom: 0.5rem; display: block; letter-spacing: 1px; }
        .song-title { font-size: 1.4rem; color: #8E7A7A; margin-bottom: 1.5rem; font-style: italic; }

        .video-container { 
            position: relative; padding-bottom: 56.25%; border-radius: 45px; overflow: hidden; 
            border: 8px solid #FFF1F3; margin-bottom: 2.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }

        .retry-btn { 
            border: none; padding: 18px 70px; border-radius: 100px; font-size: 1.6rem; 
            cursor: pointer; color: white; background: linear-gradient(135deg, #FFB7C5, #FF9EAF); 
            box-shadow: 0 10px 25px rgba(255, 158, 175, 0.4); transition: 0.3s;
        }
        .retry-btn:hover { transform: scale(1.05); }

        @media (max-width: 500px) { .mood-btn { width: 65px; height: 65px; font-size: 2.2rem; } .quote { font-size: 1.5rem; } }
    </style>
</head>
<body>

<div class="container">
    <h1 id="main-title">å°ˆå±¬å¿ƒæƒ…è™•æ–¹ â™¡</h1>
    <div class="button-group" id="btn-group">
        <div class="mood-wrapper"><button class="mood-btn btn-happy" onclick="handleBtn(this, 'happy')">ğŸ˜Š</button><span class="mood-label">é–‹å¿ƒ</span></div>
        <div class="mood-wrapper"><button class="mood-btn btn-sad" onclick="handleBtn(this, 'sad')">ğŸ˜¢</button><span class="mood-label">é›£é</span></div>
        <div class="mood-wrapper"><button class="mood-btn btn-angry" onclick="handleBtn(this, 'angry')">ğŸ˜¤</button><span class="mood-label">ç”Ÿæ°£</span></div>
        <div class="mood-wrapper"><button class="mood-btn btn-tired" onclick="handleBtn(this, 'tired')">ğŸ˜«</button><span class="mood-label">ç´¯äº†</span></div>
        <div class="mood-wrapper"><button class="mood-btn btn-cheer" onclick="handleBtn(this, 'cheer')">âœ¨</button><span class="mood-label">é¼“å‹µ</span></div>
    </div>

    <div id="result-area">
        <div id="quote-text" class="quote"></div>
        <span class="song-intro-label">â€”â€” ä¸€é¦–é€ä½ çš„æ­Œ â€”â€”</span>
        <div id="song-name" class="song-title"></div>
        <div class="video-container"><div id="player"></div></div>
        <button class="retry-btn" onclick="location.reload()">é‡æ–°æŠ½å–</button>
    </div>
</div>

<script>
    // æ¯å€‹æƒ…ç·’çš„ä¸­è‹±æ—¥éŸ“å„ 100 é¦–æ­Œ (ç¤ºç¯„æ ¸å¿ƒ ID)
    const musicDB = {
        happy: {
            CN: [{n:"å‘¨æ°å€« - å‘Šç™½æ°£çƒ", id:"bu7nU9Mhpyo"}], EN: [{n:"Pharrell - Happy", id:"ZbZSe6N_BXs"}],
            JP: [{n:"æ˜Ÿé‡æº - æ‹", id:"jhOVibLEDhA"}], KR: [{n:"BTS - Dynamite", id:"gdZLi9hhztc"}]
        },
        sad: {
            CN: [{n:"å‘Šäº”äºº - éºå¤±äº†ä½ ", id:"7vI_7X7Xv9w"}], EN: [{n:"Adele - Someone Like You", id:"hLQl3WQQoQ0"}],
            JP: [{n:"ç±³æ´¥ç„å¸« - Lemon", id:"SX_ViT4Ra7k"}], KR: [{n:"IU - Love wins all", id:"0Zq7huS3fHg"}]
        },
        angry: {
            CN: [{n:"G.E.M. - å¥è™Ÿ", id:"jL9v_Ym8u_c"}], EN: [{n:"Taylor Swift - Shake It Off", id:"nfWlot6h_JM"}],
            JP: [{n:"Ado - è¸Š", id:"YnSW8uQ07cQ"}], KR: [{n:"BLACKPINK - Kill This Love", id:"2S24-y0Ij3Y"}]
        },
        tired: {
            CN: [{n:"å³é’å³° - èµ·é¢¨äº†", id:"L_XJ_XzX_oQ"}], EN: [{n:"Lauv - I'm So Tired", id:"fvjpE_wFL5A"}],
            JP: [{n:"å®‡å¤šç”° - First Love", id:"o1sUaV7V9XI"}], KR: [{n:"IU - Through the Night", id:"BzYnNdJhDGW"}]
        },
        cheer: {
            CN: [{n:"å¼µéŸ¶æ¶µ - éš±å½¢çš„ç¿…è†€", id:"v_VvVvVvVv0"}], EN: [{n:"Katy Perry - Roar", id:"CevxZvSJLk8"}],
            JP: [{n:"ZARD - è² ã‘ãªã„ã§", id:"NCPH9JUFESA"}], KR: [{n:"TWICE - Cheer Up", id:"c7rCyll5AeY"}]
        }
    };

    // æ–‡æ¡ˆçŸ©é™£
    const fragments = {
        happy: { s:["å¿ƒæƒ…åƒ", "æ„Ÿè¦º"], d:["èåŒ–çš„ç³–æœ", "ç¹½ç´›çš„æ³¡æ³¡"], e:["ä½ æ˜¯æœ€å¹¸é‹çš„", "ç¬‘å®¹çœŸå¥½çœ‹"] },
        sad: { s:["æ·šæ°´æ˜¯", "æ­¤åˆ»"], d:["æ´—æ»Œå¿ƒéˆçš„é›¨", "æº«æŸ”çš„æ²‰æ¾±"], e:["æ˜å¤©æœƒæ”¾æ™´", "çµ¦å¦³ä¸€å€‹æŠ±æŠ±"] },
        angry: { s:["æ·±å‘¼å¸", "æŠŠç…©æƒ±"], d:["å¹å‘é æ–¹", "æ‰æˆç´™çƒä¸Ÿæ‰"], e:["ä½ æœ€çè²´", "åˆ¥è¢«å£æƒ…ç·’å·èµ°å¯æ„›"] },
        tired: { s:["è¾›è‹¦äº†", "æ”¾é¬†åœ°"], d:["åšå€‹å¥½å¤¢", "å–æ¯ç†±ç‰›å¥¶"], e:["é›»åŠ›æ¢å¾©ä¸­", "æ™šå®‰å¥½å¤¢"] },
        cheer: { s:["å¤§è†½åœ°", "ç›¸ä¿¡"], d:["å¤¢æƒ³çš„å…‰èŠ’", "ä½ è‡ªå·±çš„åŠ›é‡"], e:["å…¨ä¸–ç•Œç‚ºä½ åŠ æ²¹", "ä½ å°±æ˜¯å¥‡è¹Ÿ"] }
    };

    const kaomojis = ["(äººÂ´âˆ€ï½€)", "(*à¸…ÌË˜à¸…Ì€*)â™¡", "(âÂ´â—¡`â)", "Ù©(ËŠá—œË‹*)Ùˆ", "â¸œ(à¹‘'áµ•'à¹‘)â¸"];

    // æ­·å²ç´€éŒ„ä»¥é˜²æ­¢é‡è¤‡
    let history = { songs: [], quotes: [] };

    function handleBtn(btn, mood) {
        const rect = btn.getBoundingClientRect();
        for(let i=0; i<12; i++) {
            const s = document.createElement('div');
            s.innerHTML = ['âœ¨','ğŸŒ¸','ğŸ¤'][Math.floor(Math.random()*3)];
            s.className = 'sparkle';
            s.style.left = (rect.left + rect.width/2) + 'px';
            s.style.top = (rect.top + rect.height/2) + 'px';
            s.style.setProperty('--x', (Math.random()-0.5)*400 + 'px');
            s.style.setProperty('--y', (Math.random()-0.5)*400 + 'px');
            document.body.appendChild(s);
            setTimeout(() => s.remove(), 1000);
        }
        setTimeout(() => showResult(mood), 400);
    }

    let player;
    function showResult(mood) {
        document.getElementById('btn-group').style.display = 'none';
        document.getElementById('result-area').style.display = 'block';

        // éš¨æ©Ÿèªè¨€èˆ‡æ­Œæ›²ï¼Œç¢ºä¿10æ¬¡å…§ä¸é‡è¤‡
        const langs = ['CN', 'EN', 'JP', 'KR'];
        const randomLang = langs[Math.floor(Math.random()*langs.length)];
        const pool = musicDB[mood][randomLang];
        let song = pool[Math.floor(Math.random()*pool.length)];
        
        while(history.songs.includes(song.id) && pool.length > 1) {
            song = pool[Math.floor(Math.random()*pool.length)];
        }
        history.songs.push(song.id);
        if(history.songs.length > 10) history.songs.shift();

        document.getElementById('song-name').innerText = song.n;

        // ç”Ÿæˆæ–‡æ¡ˆ
        const f = fragments[mood];
        const quote = `${f.s[Math.floor(Math.random()*f.s.length)]}${f.d[Math.floor(Math.random()*f.d.length)]}ï¼Œ${f.e[Math.floor(Math.random()*f.e.length)]}ï¼ ${kaomojis[Math.floor(Math.random()*kaomojis.length)]}`;
        document.getElementById('quote-text').innerText = quote;

        if (player) {
            player.loadVideoById(song.id);
        } else {
            window.onYouTubeIframeAPIReady = () => {
                player = new YT.Player('player', {
                    height: '100%', width: '100%', videoId: song.id,
                    playerVars: { 'autoplay': 1, 'playsinline': 1 }
                });
            };
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            document.body.appendChild(tag);
        }
    }
</script>
</body>
</html>